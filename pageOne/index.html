<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>pageOne</title>
  <script src="cross-domain.js"></script>
  <style>
    .page-box {
      padding: 10px;
    }
    .page-name {
      font-weight: bold;
      font-size: 18px;
      margin-bottom: 10px;
    }
    .text {
      margin: 10px 0;
      color: crimson;
    }
  </style>
</head>
<body>
  <div class="page-box">
    <div class="page-name">pageOne</div>
    <button id="sendTwo">向pageTwo发送消息</button>
    <button id="sendTwoCallback">向pageTwo发送消息且回调处理</button>
    <button id="sendThird">向pageThird发送消息</button>
    <button id="sendFour">向sendPageFour发送消息</button>
    <div id="pageTwoText" class="text"></div>
    <div id="pageTwoCallBack" class="text"></div>
    <div style="margin-bottom: 10px;">
      <div style="display:inline-block; width:500px; height: 500px; border: 1px solid #dfdfdf;">
        <iframe name="pageTwo" src="http://localhost:8081/" frameborder="0" width="100%" height="100%"></iframe>
      </div>
      <div style="display:inline-block; width:500px; height: 500px; border: 1px solid #dfdfdf;">
        <iframe name="pageThird" src="http://localhost:8082/" frameborder="0" width="100%" height="100%"></iframe>
      </div>
    </div>
  </div>
  <script>
    // 向pageTwo发送消息
    var sendTwo = document.getElementById('sendTwo')
    sendTwo.onclick = function() {
      var params = {
        content: '我是父页面pageOne的数据'
      }
      CD.send('pageTwo', 'sendTwoMethod', params)
    }
    // 向pageTwo发送消息且回调处理
    var sendTwoCallback = document.getElementById('sendTwoCallback')
    sendTwoCallback.onclick = function() {
      var params = {
        content: '我是父页面pageOne的数据,请返回回调函数'
      }
      CD.send('pageTwo', 'pageTwoCallBack', params, (data) => {
        var pageTwoCallBack = document.getElementById("pageTwoCallBack");
        var txt =document.createTextNode(data.content);
        pageTwoCallBack.appendChild(txt);
      })
    }
    // 向pageThird发送消息
    var sendThird = document.getElementById('sendThird')
    sendThird.onclick = function() {
      var params = {
        content: '我是父页面pageOne的数据'
      }
      CD.send('pageThird', 'sendThirdMethod', params)
    }
    // 向pageFour发送消息
    var sendFour = document.getElementById('sendFour')
    sendFour.onclick = function() {
      var params = {
        content: '我是父页面pageOne的数据'
      }
      CD.send('pageThird', 'sendFourMethod', params)
    }
    // 接收pageTwo页面的数据
    CD.extends('sendOneMethod', (data) => {
      var pageOneText = document.getElementById("pageTwoText");
      var txt =document.createTextNode(data.content);
      pageOneText.appendChild(txt);
    })
  </script>
</body>
</html>